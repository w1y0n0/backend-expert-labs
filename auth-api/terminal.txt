Wiyono@DESKTOP-200LNFH MINGW64 /d/Programming/Dicoding/Dicoding-Back-End/7_Menjadi_Back-End_Developer_Expert/files/backend-expert-labs (208-math-api-final)
$ git checkout -b 301-auth-api-user-registration main
Switched to a new branch '301-auth-api-user-registration'

Wiyono@DESKTOP-200LNFH MINGW64 /d/Programming/Dicoding/Dicoding-Back-End/7_Menjadi_Back-End_Developer_Expert/files/backend-expert-labs (301-auth-api-user-registration)
$ git branch
  205-figure-calculator
  206-hapi-test-example
  207-math-api-hapi-test
  208-math-api-final
* 301-auth-api-user-registration
  main

======
..\auth-api>npm init --y
Wrote to D:\Programming\Dicoding\Dicoding-Back-End\7_Menjadi_Back-End_Developer_Expert\files\backend-expert-labs\auth-api\package.json:

{
  "name": "auth-api",
  "version": "1.0.0",
  "description": "",
  "main": "index.js",
  "scripts": {
    "test": "echo \"Error: no test specified\" && exit 1"
  },
  "keywords": [],
  "author": "",
  "license": "ISC",
  "type": "commonjs"
}

======
..\auth-api>npm install @hapi/hapi @hapi/jwt bcrypt dotenv nanoid@3.x.x pg

added 61 packages, and audited 62 packages in 12s

3 packages are looking for funding
  run `npm fund` for details

found 0 vulnerabilities

======
..\auth-api>npm install @types/jest eslint jest node-pg-migrate nodemon --save-dev
npm warn deprecated inflight@1.0.6: This module is not supported, and leaks memory. Do not use it. Check out lru-cache if you want a good and tested way to coalesce async requests by a key value, which is much more comprehensive and powerful.
npm warn deprecated glob@7.2.3: Glob versions prior to v9 are no longer supported

added 411 packages, and audited 473 packages in 46s

71 packages are looking for funding
  run `npm fund` for details

found 0 vulnerabilities

======
..\auth-api>npx eslint --init
You can also run this command directly using 'npm init @eslint/config@latest'.

> auth-api@1.0.0 npx
> create-config

@eslint/create-config: v1.10.0

âˆš What do you want to lint? Â· javascript
âˆš How would you like to use ESLint? Â· problems    
âˆš What type of modules does your project use? Â· commonjs
âˆš Which framework does your project use? Â· none
âˆš Does your project use TypeScript? Â· No / Yes
âˆš Where does your code run? Â· node
The config that you've selected requires the following dependencies:

eslint, @eslint/js, globals
âˆš Would you like to install them now? Â· No / Yes
âˆš Which package manager do you want to use? Â· npm
â˜•ï¸Installing...

added 1 package, changed 1 package, and audited 474 packages in 2s

72 packages are looking for funding
  run `npm fund` for details

found 0 vulnerabilities
Successfully created D:\Programming\Dicoding\Dicoding-Back-End\7_Menjadi_Back-End_Developer_Expert\files\backend-expert-labs\auth-api\eslint.config.mjs file.

---
..\auth-api>npm install eslint-config-dicodingacademy --save-dev

added 1 package, and audited 475 packages in 2s

72 packages are looking for funding
  run `npm fund` for details

found 0 vulnerabilities

======
..\auth-api>npm run lint

> auth-api@1.0.0 lint
> eslint .


D:\Programming\Dicoding\Dicoding-Back-End\7_Menjadi_Back-End_Developer_Expert\files\backend-expert-labs\auth-api\eslint.config.mjs
  1:16  error  Strings must use singlequote  quotes
  2:21  error  Strings must use singlequote  quotes
  3:30  error  Strings must use singlequote  quotes
  4:21  error  Strings must use singlequote  quotes
  8:13  error  Strings must use singlequote  quotes
  8:62  error  Strings must use singlequote  quotes
  9:13  error  Strings must use singlequote  quotes
  9:56  error  Strings must use singlequote  quotes

âœ– 8 problems (8 errors, 0 warnings)
  8 errors and 0 warnings potentially fixable with the `--fix` option.


..\auth-api>npm run lint:fix

> auth-api@1.0.0 lint:fix
> eslint . --fix

======
Menyiapkan Kebutuhan Database
------
..\auth-api>psql --username postgres
Password for user postgres: 
psql (13.21)
WARNING: Console code page (437) differs from Windows code page (1252)
         8-bit characters might not work correctly. See psql reference
         page "Notes for Windows users" for details.
Type "help" for help.

postgres=# CREATE DATABASE authapi; CREATE DATABASE authapi_test;
CREATE DATABASE
CREATE DATABASE
postgres=# GRANT ALL PRIVILEGES ON DATABASE authapi, authapi_test TO developer;
GRANT      
postgres=# exit

======
..\auth-api>npm run migrate create "create table users"

> auth-api@1.0.0 migrate
> node-pg-migrate create create table users

[dotenv@17.2.3] injecting env (5) from .env -- tip: âš™ï¸  suppress all logs with { quiet: true }
Created migration -- D:\Programming\Dicoding\Dicoding-Back-End\7_Menjadi_Back-End_Developer_Expert\files\backend-expert-labs\auth-api\migrations\1761481803267_create-table-users.js

======
..\auth-api>npm run migrate create "create table authentications"

> auth-api@1.0.0 migrate
> node-pg-migrate create create table authentications

[dotenv@17.2.3] injecting env (5) from .env -- tip: âš™ï¸  specify custom .env file path with { path: '/custom/path/.env' }
Created migration -- D:\Programming\Dicoding\Dicoding-Back-End\7_Menjadi_Back-End_Developer_Expert\files\backend-expert-labs\auth-api\migrations\1761482709471_create-table-authentications.js

======
..\auth-api>npm run migrate up

> auth-api@1.0.0 migrate
> node-pg-migrate up

[dotenv@17.2.3] injecting env (5) from .env -- tip: ðŸ‘¥ sync secrets across teammates & machines: https://dotenvx.com/ops
> Migrating files:
> - 1761481803267_create-table-users
> - 1761482709471_create-table-authentications
### MIGRATION 1761481803267_create-table-users (UP) ###
CREATE TABLE "users" (
  "id" VARCHAR(50) PRIMARY KEY,
  "username" VARCHAR(50) UNIQUE NOT NULL,
  "password" TEXT NOT NULL,
  "fullname" TEXT NOT NULL
);
INSERT INTO "public"."pgmigrations" (name, run_on) VALUES ('1761481803267_create-table-users', NOW());


### MIGRATION 1761482709471_create-table-authentications (UP) ###
CREATE TABLE "authentications" (
  "token" TEXT NOT NULL
);
INSERT INTO "public"."pgmigrations" (name, run_on) VALUES ('1761482709471_create-table-authentications', NOW());


Migrations complete!

======
..\auth-api>npm run migrate:test up 

> auth-api@1.0.0 migrate:test
> node-pg-migrate --envPath .test.env up

[dotenv@17.2.3] injecting env (5) from .test.env -- tip: âš™ï¸  specify custom .env file path with { path: '/custom/path/.env' }
> Migrating files:
> - 1761481803267_create-table-users
> - 1761482709471_create-table-authentications
### MIGRATION 1761481803267_create-table-users (UP) ###
CREATE TABLE "users" (
  "id" VARCHAR(50) PRIMARY KEY,
  "username" VARCHAR(50) UNIQUE NOT NULL,
  "password" TEXT NOT NULL,
  "fullname" TEXT NOT NULL
);
INSERT INTO "public"."pgmigrations" (name, run_on) VALUES ('1761481803267_create-table-users', NOW());


### MIGRATION 1761482709471_create-table-authentications (UP) ###
CREATE TABLE "authentications" (
  "token" TEXT NOT NULL
);
INSERT INTO "public"."pgmigrations" (name, run_on) VALUES ('1761482709471_create-table-authentications', NOW());


Migrations complete!

======
..\auth-api>npm run test:watch
 FAIL  src/Commons/exceptions/_test/ClientError.test.js
  â— Test suite failed to run

    Cannot find module '../ClientError' from 'src/Commons/exceptions/_test/ClientError.test.js'
 FAIL  src/Commons/exceptions/_test/ClientError.test.js
  ClientError
    Ã— should throw error when directly use it (16 ms)

  â— ClientError â€º should throw error when directly use it

    TypeError: expect(...).toThrowError is not a function

      3 | describe('ClientError', () => {
      4 |     it('should throw error when directly use it', () => {
    > 5 |         expect(() => new ClientError('')).toThrowError('cannot instantiate abstract class');
        |                                           ^
      6 |     });
      7 | });

      at Object.toThrowError (src/Commons/exceptions/_test/ClientError.test.js:5:43)

----------------|---------|----------|---------|---------|-------------------
File            | % Stmts | % Branch | % Funcs | % Lines | Uncovered Line #s
----------------|---------|----------|---------|---------|-------------------
All files       |       0 |        0 |       0 |       0 | 
 ClientError.js |       0 |        0 |       0 |       0 | 
----------------|---------|----------|---------|---------|-------------------
Test Suites: 1 failed, 1 total
Tests:       1 failed, 1 total
Snapshots:   0 total
Time:        5.54 s
Ran all test suites.

Watch Usage: Press w to show more.

======
downgrade
---
"devDependencies": {
    ...
    "@types/jest": "^29.5.11",
    "jest": "^29.7.0",
    ...
  }

---
..\auth-api>npm install

up to date, audited 453 packages in 2s

67 packages are looking for funding
  run `npm fund` for details

found 0 vulnerabilities

======
..\auth-api>npm run test:watch
 PASS  src/Commons/exceptions/_test/ClientError.test.js
  ClientError
    âˆš should throw error when directly use it (19 ms)

----------------|---------|----------|---------|---------|-------------------
File            | % Stmts | % Branch | % Funcs | % Lines | Uncovered Line #s 
----------------|---------|----------|---------|---------|-------------------
All files       |   66.66 |    66.66 |     100 |   66.66 |                   
 ClientError.js |   66.66 |    66.66 |     100 |   66.66 | 9-10              
----------------|---------|----------|---------|---------|-------------------
Test Suites: 1 passed, 1 total
Tests:       1 passed, 1 total
Snapshots:   0 total
Time:        1.511 s, estimated 2 s
Ran all test suites.

Watch Usage: Press w to show more.

======
 PASS  src/Commons/exceptions/_test/ClientError.test.js
 PASS  src/Commons/exceptions/_test/InvariantError.test.js
-------------------|---------|----------|---------|---------|-------------------
File               | % Stmts | % Branch | % Funcs | % Lines | Uncovered Line #s
-------------------|---------|----------|---------|---------|-------------------
All files          |     100 |      100 |     100 |     100 | 
 ClientError.js    |     100 |      100 |     100 |     100 | 
 InvariantError.js |     100 |      100 |     100 |     100 | 
-------------------|---------|----------|---------|---------|-------------------

Test Suites: 2 passed, 2 total
Tests:       2 passed, 2 total
Snapshots:   0 total
Time:        1.341 s
Ran all test suites.

Watch Usage: Press w to show more.

======
 PASS  src/Commons/exceptions/_test/ClientError.test.js
 PASS  src/Commons/exceptions/_test/InvariantError.test.js
 PASS  src/Commons/exceptions/_test/AuthenticationError.test.js
------------------------|---------|----------|---------|---------|-------------------
File                    | % Stmts | % Branch | % Funcs | % Lines | Uncovered Line #s
------------------------|---------|----------|---------|---------|-------------------
All files               |     100 |      100 |     100 |     100 |                   
 AuthenticationError.js |     100 |      100 |     100 |     100 |                   
 ClientError.js         |     100 |      100 |     100 |     100 |                   
 InvariantError.js      |     100 |      100 |     100 |     100 |                   
------------------------|---------|----------|---------|---------|-------------------

Test Suites: 3 passed, 3 total
Tests:       3 passed, 3 total
Snapshots:   0 total
Time:        1.397 s, estimated 4 s
Ran all test suites.

Watch Usage: Press w to show more.

======